[
    {
        "hosts": "all",
        "gather_facts": "false",
        "remote_user": "root"
    },
    {
        "hosts": "Ghost",
        "remote_user": "root",
        "tasks": [
            {
                "name": "install php",
                "apt": {
                    "name": "php7.0",
                    "allow_unauthenticated": "yes",
                    "update_cache": "no"
                }
            },
            {
                "name": "install php-cgi",
                "apt": {
                    "name": "php7.0-cgi",
                    "allow_unauthenticated": "yes",
                    "update_cache": "no"
                }
            },
            {
                "name": "install php-mysql",
                "apt": {
                    "name": "php7.0-mysql",
                    "allow_unauthenticated": "yes",
                    "update_cache": "no"
                }
            },
            {
                "name": "install apache2",
                "apt": {
                    "name": "apache2",
                    "allow_unauthenticated": "yes",
                    "update_cache": "no"
                }
            },
            {
                "name": "install mariadb",
                "apt": {
                    "name": "mariadb-server",
                    "allow_unauthenticated": "yes",
                    "update_cache": "no"
                }
            },
            {
                "name": "install python-mysqldb",
                "apt": {
                    "name": "python-mysqldb",
                    "allow_unauthenticated": "yes",
                    "update_cache": "no"
                }
            },
            {
                "name": "create database",
                "mysql_db": {
                    "name": "Ghost",
                    "state": "present",
                    "encoding": "utf8"
                }
            },
            {
                "name": "create database user",
                "mysql_user": {
                    "name": "Ghost",
                    "password": "Ghost",
                    "priv": "Ghost.*:ALL"
                }
            },
            {
                "name": "create Ghost config",
                "command": "ghost config create --dbname=ghost --dbuser=ghost --dbpass=ghost --allow-root",
                "args": {
                    "chdir": "/var/www/html",
                    "creates": "/var/www/html/ghost-config.php"
                }
            },
            {
                "name": "install ghost",
                "command": "ghost core install --url={{domain_name}} --title='{{site_title}}' --admin_user={{admin_user}} --admin_password={{admin_pwd}} --admin_email=info@wp-cli.org --allow-root",
                "args": {
                    "chdir": "/var/www/html"
                }
            },
            {
                "name": "remove index.html",
                "file": {
                    "name": "/var/www/html/index.html",
                    "state": "absent"
                }
            },
            {
                "name": "change file ownership",
                "file": {
                    "path": "/var/www/html",
                    "recurse": "yes",
                    "owner": "www-data",
                    "group": "www-data"
                }
            },
            {
                "name": "restart apache",
                "service": {
                    "name": "apache2",
                    "state": "restarted"
                }
            }
        ]
    }
]